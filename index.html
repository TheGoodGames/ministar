<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lin: Drake Clipper</title>
    
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Google Fonts: Merriweather -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,opsz,wght@0,18..144,300..900;1,18..144,300..900&display=swap" rel="stylesheet">
    
    <!-- –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="css/base.css">
    
    <!-- –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç—ã (–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ä–∞–∑—É –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏) -->
    <link rel="stylesheet" href="css/map.css">
</head>
<body>
    <div id="app">
        <div id="scene" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ–ª–µ–Ω–Ω–æ–π‚Ä¶</div>
    </div>
    <button id="audio-control" onclick="toggleAudio()">üîá</button>

    <!-- –≠–∫—Ä–∞–Ω –±—Ä–æ—Å–∫–∞ –∫—É–±–∏–∫–æ–≤ -->
    <div id="dice-screen" style="display: none;">
        <div class="dice">üé≤ üé≤</div>
        <div class="result">–ë—Ä–æ—Å—å—Ç–µ –∫–æ—Å—Ç–∏, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏—Å—Ö–æ–¥.</div>
        <button class="choice-btn" id="roll-button">–ë—Ä–æ—Å–∏—Ç—å –∫–æ—Å—Ç–∏</button>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –∞–Ω–∏–º–∞—Ü–∏–∏ –∫–ª—é—á–∞ -->
    <div id="key-animation" style="display: none; text-align: center; padding: 40px 20px;">
        <div class="icon" id="anim-key-icon" style="font-size: 120px; margin-bottom: 20px; opacity: 0; animation: keyPop 1.1s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;">üóùÔ∏è</div>
        <div class="label" id="anim-key-label" style="font-size: 22px; margin-bottom: 30px; opacity: 0; animation: fadeIn 0.8s 0.4s forwards;">–ù–æ–≤—ã–π –∫–ª—é—á!</div>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –º–æ–¥—É–ª–µ–π -->
    <div id="module-container"></div>

    <audio id="ambient-audio" loop preload="auto">
        <source src="audio/ambient-loop.mp3" type="audio/mpeg">
    </audio>

    <!-- –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º —É—Ç–∏–ª–∏—Ç—ã -->
    <script src="js/utils.js"></script>
    
    <!-- –ü–æ—Ç–æ–º –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É -->
    <script src="js/game-core.js"></script>
    
    <!-- –ó–∞—Ç–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é -->
    <script src="js/config-loader.js"></script>
    
    <!-- –ò —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –º–æ–¥—É–ª–∏ -->
    <script src="modules/inventory.js" defer></script>
    <script src="modules/map.js" defer></script>
    
    <!-- –°–∫—Ä–∏–ø—Ç –æ—Ç–ª–∞–¥–∫–∏ -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log('‚úÖ DOM –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω');
            console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:');
            console.log('  #scene:', document.getElementById('scene') ? '‚úÖ –Ω–∞–π–¥–µ–Ω' : '‚ùå –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç');
            console.log('  #dice-screen:', document.getElementById('dice-screen') ? '‚úÖ –Ω–∞–π–¥–µ–Ω' : '‚ùå –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç');
            console.log('  #module-container:', document.getElementById('module-container') ? '‚úÖ –Ω–∞–π–¥–µ–Ω' : '‚ùå –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
            setTimeout(() => {
                const debugContainer = document.createElement('div');
                debugContainer.style.position = 'fixed';
                debugContainer.style.bottom = '20px';
                debugContainer.style.left = '20px';
                debugContainer.style.zIndex = '1000';
                debugContainer.style.backgroundColor = 'rgba(40, 40, 40, 0.8)';
                debugContainer.style.padding = '10px';
                debugContainer.style.borderRadius = '5px';
                debugContainer.style.color = 'white';
                debugContainer.style.fontSize = '12px';
                
                //debugContainer.innerHTML = `
                //    <button onclick="debugMapModule()" style="margin: 5px; padding: 5px 10px; background: #3a3c6d; color: white; border: none; border-radius: 3px; cursor: pointer;">üîç –û—Ç–ª–∞–¥–∫–∞ –∫–∞—Ä—Ç—ã</button>
                //    <button onclick="addTestLocation()" style="margin: 5px; padding: 5px 10px; background: #4caf50; color: white; border: none; border-radius: 3px; cursor: pointer;">üìç –¢–µ—Å—Ç–æ–≤–∞—è –ª–æ–∫–∞—Ü–∏—è</button>
                `;
                
                document.body.appendChild(debugContainer);
            }, 1000);
        });
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π –ª–æ–∫–∞—Ü–∏–∏
        function addTestLocation() {
            if (window.addLocation) {
                window.addLocation('test_location');
                alert('‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è –ª–æ–∫–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
                window.debugMapModule();
            } else {
                alert('‚ùå –ú–æ–¥—É–ª—å –∫–∞—Ä—Ç—ã –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
            }
        }
    </script>
</body>
</html>
